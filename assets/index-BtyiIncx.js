import{u as L,r as C,a as r,o as M,m as O,b as R,d as j,c as J,e as b,f as k,g as t,h as w,w as l,i as _,t as y,j as u,F as $,k as H,l as G,n as K,P as Q,E as W,p as X,q as Z,s as ee,v as te,x as ae,y as le,z as oe,A as ne,B as se,C as ie,D as re}from"./index-gHtfuMJj.js";const ue={class:"admin-container"},de={style:{display:"flex","align-items":"center"}},me={style:{display:"flex","align-items":"center"}},pe={style:{"margin-left":"10px"}},_e={class:"pagination-info"},ce={class:"dialog-footer"},be={__name:"index",setup(fe){const x=L(),d=C({pageNum:1,pageSize:10}),m=C({list:[],total:0});let c=r([]);M(()=>{f(),O().then(({data:o})=>{c.value=o.data})});const f=()=>{R(d).then(({data:o})=>{const{list:a,total:i}=o.data;a.forEach(n=>{n.create_time=j(n.create_time).format("YYYY-MM-DD")}),m.list=a,m.total=i})},N=o=>{d.pageNum=o,f()},p=r(!1),D=r({name:[{required:!0,trigger:"blur",message:"请填写昵称"}],permissions_id:[{required:!0,trigger:"blur",message:"请选择菜单权限"}]}),s=r({}),B=o=>{p.value=!0,s.value=JSON.parse(JSON.stringify(o))},V=r(),S=async o=>{o&&await o.validate((a,i)=>{if(a){const{name:n,permissions_id:g}=s.value;K({name:n,permissions_id:g}).then(()=>{p.value=!1,f()})}else console.log("error submit!",i)})},F=o=>{const a=c.value.find(i=>i.id===o);return a?a.name:"超级管理员"};return(o,a)=>{const i=Q,n=W,g=X,U=J("Clock"),P=Z,E=ee,T=te,Y=ae,h=le,v=oe,q=ne,z=se,A=ie,I=re;return b(),k("div",ue,[t(i,{info:w(x)},null,8,["info"]),t(T,{data:m.list,stripe:"",style:{width:"100%"}},{default:l(()=>[t(n,{label:"id",prop:"id"}),t(n,{label:"昵称",prop:"name"}),t(n,{label:"所属组别",prop:"permissions_id"},{default:l(e=>[_(y(F(e.row.permissions_id)),1)]),_:1}),t(n,{label:"手机号",prop:"mobile"}),t(n,{label:"状态",prop:"active"},{default:l(e=>[u("div",de,[t(g,{type:e.row.active?"success":"danger"},{default:l(()=>[_(y(e.row.active?"正常":"失效"),1)]),_:2},1032,["type"])])]),_:1}),t(n,{label:"创建时间"},{default:l(e=>[u("div",me,[t(P,null,{default:l(()=>[t(U)]),_:1}),u("span",pe,y(e.row.create_time),1)])]),_:1}),t(n,{label:"操作"},{default:l(e=>[t(E,{type:"primary",onClick:ge=>B(e.row)},{default:l(()=>[_("编辑")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),u("div",_e,[t(Y,{"current-page":d.pageNum,"onUpdate:currentPage":a[0]||(a[0]=e=>d.pageNum=e),size:"small",background:!1,layout:"total, prev, pager, next",total:m.total,onCurrentChange:N},null,8,["current-page","total"])]),t(I,{modelValue:p.value,"onUpdate:modelValue":a[5]||(a[5]=e=>p.value=e),title:"编辑用户",width:"500"},{footer:l(()=>[u("div",ce,[t(E,{type:"primary",onClick:a[4]||(a[4]=e=>S(V.value))},{default:l(()=>[_(" 确认 ")]),_:1})])]),default:l(()=>[t(A,{"label-width":"100px","label-position":"left",model:s.value,rules:D.value,ref_key:"formRef",ref:V},{default:l(()=>[t(v,{label:"手机号",prop:"mobile"},{default:l(()=>[t(h,{modelValue:s.value.mobile,"onUpdate:modelValue":a[1]||(a[1]=e=>s.value.mobile=e),disabled:""},null,8,["modelValue"])]),_:1}),t(v,{label:"昵称",prop:"name"},{default:l(()=>[t(h,{modelValue:s.value.name,"onUpdate:modelValue":a[2]||(a[2]=e=>s.value.name=e)},null,8,["modelValue"])]),_:1}),t(v,{label:"菜单权限",prop:"permissions_id"},{default:l(()=>[t(z,{modelValue:s.value.permissions_id,"onUpdate:modelValue":a[3]||(a[3]=e=>s.value.permissions_id=e),placeholder:"请选择菜单权限",style:{width:"240px"}},{default:l(()=>[(b(!0),k($,null,H(w(c),e=>(b(),G(q,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}};export{be as default};
