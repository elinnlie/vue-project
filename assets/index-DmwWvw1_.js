import{_ as F,u as S,r as m,a as _,o as U,G as L,H as M,e as $,f as j,g as e,h as E,j as v,w as l,i as y,I as G,J as H,K as J,L as O,M as q,P as A,s as Q,E as W,v as X,x as Y,y as Z,z as ee,N as te,C as ae,D as oe}from"./index-gHtfuMJj.js";const le={class:"group-container"},ne={class:"btns"},se={class:"pagination-info"},ie={class:"dialog-footer"},re={__name:"index",setup(de){const w=S(),d=m({pageNum:1,pageSize:10}),u=m({list:[],total:0}),k=_([]);U(()=>{f(),L().then(({data:a})=>{k.value=a.data})});const f=()=>{M(d).then(({data:a})=>{const{list:t,total:i}=a.data;u.list=t,u.total=i})},n=m({id:"",name:""}),g=_(),I=m({authName:[{required:!0,trigger:"blur",message:"请输入权限名称"}]}),K=a=>{d.pageNum=a,f()},p=_(!1),x=(a={})=>{p.value=!0,O(()=>{a&&(Object.assign(n,{id:a.id,authName:a.name}),c.value.setCheckedKeys(a.permission))})},N=()=>{p.value=!1,g.value.resetFields(),c.value.setCheckedKeys(C)},P={children:"children",label:"label"},c=_(),C=[4,5],R=async a=>{a&&await a.validate((t,i)=>{if(t){const r=n.authName,s=n.id,h=JSON.stringify(c.value.getCheckedKeys());q({id:s,name:r,permissions:h}).then(()=>{N(),f()})}else console.log("error submit!",i)})};return(a,t)=>{const i=A,r=Q,s=W,h=X,T=Y,V=Z,b=ee,z=te,B=ae,D=oe;return $(),j("div",le,[e(i,{info:E(w)},null,8,["info"]),v("div",ne,[e(r,{onClick:t[0]||(t[0]=o=>x(null)),type:"primary",size:"small",icon:E(G)},{default:l(()=>[y("新增")]),_:1},8,["icon"])]),e(h,{data:u.list,stripe:"",style:{width:"100%"}},{default:l(()=>[e(s,{label:"id",prop:"id"}),e(s,{label:"昵称",prop:"name"}),e(s,{label:"菜单权限",prop:"permissionName",width:"500px"}),e(s,{label:"操作"},{default:l(o=>[e(r,{type:"primary",onClick:ue=>x(o.row)},{default:l(()=>[y("编辑")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),v("div",se,[e(T,{"current-page":d.pageNum,"onUpdate:currentPage":t[1]||(t[1]=o=>d.pageNum=o),size:"small",background:!1,layout:"total, prev, pager, next",total:u.total,onCurrentChange:K},null,8,["current-page","total"])]),e(D,{modelValue:p.value,"onUpdate:modelValue":t[5]||(t[5]=o=>p.value=o),"before-close":N,title:"添加权限",width:"500"},{footer:l(()=>[v("div",ie,[e(r,{type:"primary",onClick:t[4]||(t[4]=o=>R(g.value))},{default:l(()=>[y(" 确认 ")]),_:1})])]),default:l(()=>[e(B,{ref_key:"formRef",ref:g,"label-width":"100px","label-position":"left",model:n,rules:I},{default:l(()=>[H(e(b,{prop:"id"},{default:l(()=>[e(V,{modelValue:n.id,"onUpdate:modelValue":t[2]||(t[2]=o=>n.id=o),placeholder:"请输入昵称"},null,8,["modelValue"])]),_:1},512),[[J,!1]]),e(b,{label:"名称",prop:"authName"},{default:l(()=>[e(V,{modelValue:n.authName,"onUpdate:modelValue":t[3]||(t[3]=o=>n.authName=o),placeholder:"请填写权限名称"},null,8,["modelValue"])]),_:1}),e(b,{label:"权限",prop:"authInfo"},{default:l(()=>[e(z,{ref_key:"treeRef",ref:c,style:{"max-width":"600px"},data:k.value,"show-checkbox":"","node-key":"id","default-expanded-keys":[2],"default-checked-keys":C,props:P},null,8,["data"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}},ce=F(re,[["__scopeId","data-v-2a7dcd04"]]);export{ce as default};
